<!DOCTYPE html>
<html lang="en">
	<head>
		<title>MODF</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #262626;
				color: #fff;
				margin: 0px;
				overflow: hidden;
			}
			#info {
				color: #fff;
				position: absolute;
				top: 200px;
				width: 100%;
				text-align: center;
				z-index: 100;
				display:block;
			}

			left_rotate {
				position: absolute;
				top: 100px;
				left: 100px;
			}
			#info a, .button { color: #f00; font-weight: bold; text-decoration: underline; cursor: pointer }

			#wrapper {
                background: #000000;
                opacity: 1;
                position: fixed;
                z-index: 10;
                top: 0px;
                width: 100%;
                height: 1600px;
            }

            #loader {
                background: url('./images/loading.png') 50% 50% no-repeat;
                width: 100px;
                height: 100px;
                margin: 300px auto;

            }
            <!--http://img5.duitang.com/uploads/blog/201406/26/20140626105654_aVuNR.gif-->
		</style>
	</head>

	<body>
		<div id="wrapper">
			<div id="loader"></div>
		</div>
		<div class="text" style="text-align:center;  color:#00ffff">
			<table style=" align:center; valign=middle;  color:#00ffff; width:100%">
				<tr>
					<td></td>
					<td style="width:30%;"><img id="left_icon" style="width:30px;" onclick="goto_left" src="./images/left.png" /></td>
					<td ><p id="step_text">请选择一根长度为：8米的网线。</p></td>
					<td style="width:30%;"><img id="right_icon" style="width:30px;" onclick="goto_right" src="./images/right.png" /></td>
					<td></td>
				</tr>
			</table>
		</div>
		<div id="left_rotate" style="position:absolute; left:75%; top:75%"><!--style="position:absolute; left:1150px; top:550px; color:#ff00ff; width:260px; height: 150px"-->
			<img id="turnleft_icon" src="./images/btn-turnleft-normal.png"  style="position:relative; left:0px; top:0px;"/>
			<img id="turnright_icon" src="./images/btn-turnright-normal.png" style="position:relative; left:0px; top:0px;"/>
			<img id="zoomin_icon" src="./images/btn-zoomin-normal.png" style="position:relative; left:0px; top:0px;"/>
			<img id="zoomout_icon" src="./images/btn-zoomout-normal.png" style="position:relative; left:0px; top:0px;"/>
			<img id="reset_icon" src="./images/btn-reset-normal.png" style="position:relative; left:0px; top:0px;"/>
		</div>
	<!--	<div id="line" style="text-align:right">
			<button type="button" onclick="line()">连线</button>
		</div>
-->
		<script src="build/three.js"></script>

		<script src="js/loaders/DDSLoader.js"></script>
		<script src="js/loaders/MTLLoader.js"></script>
		<script src="js/loaders/OBJLoader.js"></script>
		<script src="js/controls/TrackballControls.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/libs/stats.min.js"></script>

		<script>

			var container, stats, controls;

			var camera, scene, renderer;

			var mouseX = 0, mouseY = 0;
			var isDraw = 0;
			var windowHalfX = window.innerWidth / 2;
			var windowHalfY = window.innerHeight / 2;
			var cube1;
			var json1;
			var json_index = 0;
			var geometry1 ; //圆柱线
			var obj_count = 1;


            window.addEventListener("load", function() {
                var wrapper = document.getElementById("wrapper");
                document.body.removeChild(wrapper);
            });

			var getJSON = function(url) {
			  return new Promise(function(resolve, reject) {
				var xhr = new XMLHttpRequest();
				xhr.open('get', url, true);
				xhr.responseType = 'json';
				xhr.onload = function() {
				  var status = xhr.status;
				  if (status == 200) {
					resolve(xhr.response);
				  } else {
					reject(status);
				  }
				};
				xhr.send();
			  });
			};

			getJSON('http://116.62.23.7:8082/api/v1.0/render').then(function(data) {
				//Json解析
				var parse_json_by_eval = function(str){
					return eval('('+str+')');
				}
				var value = 1;
				var jsonstr = '{"count":"1","step0": ["请选择一根长度为：8米的网线。", "先从1#机架的96芯设备单元1(1,1)端口出来往下经过下方邻近的8位小线环。", "往右穿过中线环再到设备单元1的大线环1" , "穿过大线环1后，往上经过1#机架侧面第1个挂纤轮。再到最下面的挂纤轮，调头向上绕过1#机架侧面第1个挂纤轮。", "往下进入1#机架的96芯设备单元2的大线环1。", "从1#机架的96芯设备单元2的大线环1出来后，往左进入1#机架设备单元2的中线环，并将线嵌入邻近的8位小线环中。", "最后往上将线插入1#机架96芯设备单元2(1,1)的端口中。"],"step1":"A(1,1)","step2":"A-小孔","step3": "B-大孔","step4": "挂纤轮-1","step5": "2-大线环1","step6": "2(1,1)","step7": "","step8":"","step9":"","step10":""}';
				if(data){
					//json1= parse_json_by_eval(data);
					var result = data.step0;
					if(result == "Failed"){
						json1= parse_json_by_eval(jsonstr);
					}else{
						json1= data;
					}
				}else{
					json1= parse_json_by_eval(jsonstr);
				}

				//显示步骤
				var x = json1.step0[0];
				document.getElementById("step_text").innerHTML=x;
				obj_count = parseInt(json1.count);
				if(obj_count == 1){
					drawLineNewOne();
				}else{
					//绘画两个机架，相对复杂
				}
			}, function(status) { //error detection....
			  alert('Something went wrong.');
			});

			init();
			animate();

			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.z = 800;


				controls = new THREE.TrackballControls( camera );

				// scene
				scene = new THREE.Scene();

				var ambient = new THREE.AmbientLight(0x888888);//( 0x444444 );
				scene.add( ambient );

				var directionalLight = new THREE.DirectionalLight(0xffffff);//( 0xffeedd );
				directionalLight.position.set( 5, 5, 1 ).normalize();
				scene.add( directionalLight );

				// model
				var onProgress = function ( xhr ) {
					if ( xhr.lengthComputable ) {
						var percentComplete = xhr.loaded / xhr.total * 100;
						console.log( Math.round(percentComplete, 2) + '% downloaded' );
					}
				};

				var onError = function ( xhr ) { };

				THREE.Loader.Handlers.add( /\.dds$/i, new THREE.DDSLoader() );

				//添加第一个对象
				var mtlLoader = new THREE.MTLLoader();
				mtlLoader.setPath( 'obj/3D/' );
				if(obj_count ==1){
					mtlLoader.load( '3DBuilder.mtl', function( materials ) {
						materials.preload();

						var objLoader = new THREE.OBJLoader();
						objLoader.setMaterials( materials );
						objLoader.setPath( 'obj/3D/' );
						objLoader.load( '3DBuilder.obj', function ( object ) {
							object.position.y = -250;
							scene.add( object );

						}, onProgress, onError );

					});
				}else{
					mtlLoader.load( '3DBuilder.mtl', function( materials ) {
						materials.preload();

						var objLoader = new THREE.OBJLoader();
						objLoader.setMaterials( materials );
						objLoader.setPath( 'obj/3D/' );
						objLoader.load( '3DBuilder.obj', function ( object ) {
							object.position.x = -150
							object.position.y = -250;
							scene.add( object );

						}, onProgress, onError );

					});

					//添加第二个对象

					mtlLoader.load( '3DBuilder.mtl', function( materials ) {
						materials.preload();
						var objLoader2 = new THREE.OBJLoader();
						objLoader2.setMaterials( materials );
						objLoader2.setPath( 'obj/3D/' );
						objLoader2.load( '3DBuilder.obj', function ( object2 ) {

							object2.position.y = -250;
							object2.position.x = 150;
							scene.add( object2);

						}, onProgress, onError );

					});
				}

				renderer = new THREE.WebGLRenderer({ antialias: true });
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				container.appendChild( renderer.domElement );
		 		initImageIcon();
		 		controls.revertTO(); //just for test
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function onDocumentMouseMove( event ) {
				mouseX = ( event.clientX - windowHalfX ) / 2;
				mouseY = ( event.clientY - windowHalfY ) / 2;
			}

			function animate() {
				controls.update();
				renderer.render( scene, camera );
				requestAnimationFrame( animate );
			}

			function render() {
				camera.position.x += ( mouseX - camera.position.x ) * .05;
				camera.position.y += ( - mouseY - camera.position.y ) * .05;
				camera.lookAt( scene.position );
				renderer.render( scene, camera );

			}



			function drawLineNewOne(){
				/*
					变量的定义
				*/
				//开始的节点
				var startModel, start_X, start_Y, startType;
				//结束的节点
				var endModel, end_X, end_Y, endType;
				var firstHole, secondHole;
				//挂纤轮
				var firstLineLoop, secondLineLoop;
				//大线环
				var bigLineLoop, bigLineLoopIndex;
				var r_index;

				//96芯的节点
				//var 96Model_Start, 96_X_Start, 96_Y_Start;
				//var 96Model_End, 96_X_End, 96_Y_End;

				/*
				* A(1,1)		->1
				* A-小孔         ->2
				* B-大孔         ->3
				* 挂纤轮-1       ->4
				* 2-大线环1		->5
				* 2(1,1)		->6
				*/
				/*
				* startType
				* 0 72芯
				* 1 96芯
				*/
 				var stringArray = new Array(json1.step1, json1.step2, json1.step3, json1.step4, json1.step5, json1.step6, json1.step7, json1.step8, json1.step9, json1.step10);
				var typeString;
 				//json1.step1  -> step1一般都是从口子出来
 				for(var i = 0; i < stringArray.length; i++){
 					if(stringArray[i] != ""){
						typeString = checkStepString(stringArray[i]);
						var stepString = stringArray[i];

						switch(typeString){
							case 1:
							{
								//如果是第一步，则是start, 如果不是第一不，则不是start
								r_index = stepString.indexOf(")");
								if(i == 0){
									//解析成start,
									startType = 0;
									startModel = stepString.substr(0,1);
									start_X = parseInt(stepString.substr(2,1));
									start_Y = parseInt(stepString.substring(4,r_index));
								}else{
									//解析成end
									endType = 1;
									endModel = stepString.substr(0,1);
									end_X = parseInt(stepString.substr(2,1));
									end_Y = parseInt(stepString.substring(4, r_index));
								}
							}
							break;
							//大小孔合并
							case 2:
							case 3:
							{
								//找出是哪个单元的
								var holeString = stepString.substr(0,1);
								firstHole = convertABC(holeString);

							}
							break;
							case 4:
							{
								//一共13个挂线轮
								if(firstLineLoop== undefined){
									firstLineLoop  = parseInt(stepString.substr(stepString.length -1, 1));
								}else{
									secondLineLoop  = parseInt(stepString.substr(stepString.length -1, 1));

								}
							}
							break;
							case 5:
							{
								bigLineLoop = parseInt(stepString.substr(0, 1));
								bigLineLoopIndex = parseInt(stepString.substr(stepString.length - 1, 1));
							}
							break;
							case 6:
							{
								//如果是第一步，则是start, 如果不是第一不，则不是start
								r_index = stepString.indexOf(")");
								if(i == 0){
									//解析成start,
									startType = 0;
									startModel = parseInt(stepString.substr(0,1));
									start_X = parseInt(stepString.substr(2,1));
									start_Y = parseInt(stepString.substring(4,r_index));
								}else{
									//解析成end
									endType = 1;
									endModel = parseInt(stepString.substr(0,1));
									end_X = parseInt(stepString.substr(2,1));
									end_Y = parseInt(stepString.substring(4, r_index));
								}
							}
							break;
						}
 					}
 				}


				//drawPointLineOne(0, "L", 1, 1);
				//如果是从72芯片的开始
				if(startType == 0){
					//开始画线, 画出来的线
					drawPointLineOne(startType, startModel, start_X, start_Y);

					//画点到孔
					drawLineToHole(startModel, firstHole, start_X); // i -> firstHole
					//画边线~
					drawLinePointToCircleOne(firstHole);	// i -> firstHole
				}else{

				}

				//画挂纤轮,挂纤轮需要进口和出口
				drawLineLoop(firstLineLoop, firstHole, bigLineLoop, bigLineLoopIndex);


				//绘画

				//画终点
				if(endType == 0){
					//开始画线, 画出来的线
					drawPointLineOne(startType, endModel, end_X, end_Y);
					//画点到孔
					drawLineToHole(endModel, firstHole, end_X); // i -> firstHole
					//画边线~
					drawLinePointToCircleOne(firstHole);	// i -> firstHole
				}else{
					//for(var i = 1; i <= 24; i++){
					drawPointOf96(endModel, end_X, end_Y);
					//}
                 }
			}


			function line(){
				/*
				* String的类型   ->1
				* A(1,1)		->2
				* A-小孔         ->3
				* B-大孔         ->4
				* 挂纤轮-1       ->5
				* 2-大线环1		->6
				* 2(1,1)		->7
 				*/

				//解析json的数据，进行绘画
				var model_index, x_index, y_index;
				var to_model_index, to_x_index, to_y_index;
				var circle_index, to_circle_index;

				//start


				//to
				var to = json1.step7;
				r_index = to.indexOf(")");
				to_model_index = parseInt(to.substr(0,1));
				to_x_index = parseInt(to.substr(2,1));
				to_y_index = parseInt(to.substring(4,r_index));

				//start_circle
				var startCircle = json1.step3;
				var index1 = startCircle.indexOf("-");
				circle_index = parseInt(startCircle.substring(index1+1));

				var toCircle = json1.step4;
				var index2 = startCircle.indexOf("-");
				to_circle_index = parseInt(toCircle.substring(index2+1));

				if(isDraw == 0){
					//Point到边界的值
					drawPointLine(model_index,x_index,y_index);
					//drawPointLine(1,1,1);
					//拐点到圆环
					drawLinePointToCircle(model_index,x_index);


					//画圆环
					drawCircle(circle_index);

					//圆环到另一个圆环
					drawCircleToCircle(circle_index,to_circle_index);

					//画圆环的圈
					drawCircle(to_circle_index);

					drawLine(model_index,to_model_index);

					//目标点Point到边界的线
					drawPointLine(to_model_index,x_index,y_index);
					//目标点拐点到圆环的线
					drawLinePointToCircle(to_model_index,x_index);
					isDraw = 1;
				}else{
					//do nothing
				}


			}

			function getPointCubeByModelIndex(model_index, x_index,pointCube){
				switch(model_index){
					case 1:
					{
						pointCube.position.y = 232 - (x_index - 1)*4;
					}
					break;

					case 2:
					{
						pointCube.position.y = 202 - (x_index - 1)*4;

					}
					break;

					case 3:
					{
						pointCube.position.y = 174 - (x_index - 1)*4;
					}
					break;
					case 4:
						pointCube.position.y = 144 - (x_index - 1)*4;
					break;


					case 5:
						pointCube.position.y = 72 - (x_index - 1)*4;
					break;

					case 6:
						pointCube.position.y = 44 - (x_index - 1)*4;

					break;

					case 7:
						pointCube.position.y = 14 - (x_index - 1)*4;

					break;

					case 8:
						pointCube.position.y = -15 - (x_index - 1)*4;
					break;

					case 9:
						pointCube.position.y = -90 - (x_index - 1)*4;

					break;

					case 10:
						pointCube.position.y = -120 - (x_index - 1)*4;

					break;

					case 11:
						pointCube.position.y = -150 - (x_index - 1)*4;

					break;
					case 12:
						pointCube.position.y = -178 - (x_index - 1)*4;
					break;
				}
				return pointCube;
			}


			/*
			*	画开始的点
			*	区分两种情况， 是72芯的点还是96芯的点
			*
			*/
			function drawPointLineOne(startType, startMode, start_X, start_Y){

				if(startType == 0){
					//(0,0点的坐标)
					var material = new THREE.MeshBasicMaterial( { color: 0xfdc534} );
					var model_index = convertABC(startMode); //-> just for test
					var z_position = 46;
					switch(start_Y){
						case 1:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 16, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -42;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);

						break;

						case 2:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 21, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -40;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);

						break;

						case 3:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 25, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -38;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;
						case 4:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -36;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;
						case 5:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 33, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -34;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 6:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 36, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -33;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 7:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 39, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -31;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 8:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 42, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -29;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 9:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 45, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -28;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 10:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 48, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -26;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;

						case 11:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 51, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -25;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;
						case 12:
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 52, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);

							//只有y是不一样的
							pointCube.rotation.z = 1.58;
							pointCube.position.x = -23;
							pointCube.position.z = z_position;
							getPointCubeByModelIndex(model_index, start_X, pointCube);
						break;
					}
				}else{

				}
				scene.add(pointCube);
			}

			//将A, B, C, D, E, F, G, H, I转化为数字
			function convertABC(ModelChar){
				var convertResult = 0;
				//var testArray = {'A','B'};
				var convertArray = new Array("A","B","C","D","E","F","G","H","I","J","K","L");
				var resultArray = new Array(1,2,3,4,5,6,7,8,9,10,11,12);
				for(var i = 0; i < convertArray.length; i++){
					if(ModelChar == convertArray[i]){
						return resultArray[i];
					}
				}
			}

			/*
			* 72芯画线到大小孔的位置
			*/
			function drawLineToHole(Model, hole_index,x_index){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				var ModeIndex = convertABC(Model);
				var z_position = 46;
				//ModeIndex =12;
				//hole_index = 12;
				//x_index = 1;
				if(ModeIndex > hole_index){
					return;
				}
				switch(ModeIndex){
					case 1:
					{
						if(hole_index <= 4){
							var calIndex = hole_index -1;
							var calIndex_X = x_index -1;
							var length = 25+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 220 - calIndex*15 -calIndex_X *2;					//起始是220
						}else if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-1;
							var calIndex_X = x_index -1;

							var length = 184+ calIndex*33 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 139.5 - calIndex*16.5 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 346+ calIndex*33 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 59.5 - calIndex*16.5 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 2:
					{
						if(hole_index <= 4){
							var calIndex = hole_index -2;
							var calIndex_X = x_index -2;
							var length = 20+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 188.5 - calIndex*15 -calIndex_X *2;					//起始是220
						}else if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-1;
							var calIndex_X = x_index -1;

							var length = 152+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 126 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 316+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 44.5 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 3:
					{
						if(hole_index <= 4){
							var calIndex = hole_index -3;
							var calIndex_X = x_index -3;
							var length = 17+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 158.5 - calIndex*15 -calIndex_X *2;					//起始是220
						}else if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-1;
							var calIndex_X = x_index -1;

							var length = 126+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 112 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 287+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 30 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;
					case 4:
					{
						if(hole_index <= 4){
							var calIndex = hole_index -4;
							var calIndex_X = x_index -4;
							var length = 12+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 126.5 - calIndex*15 -calIndex_X *2;					//起始是220
						}else if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-1;
							var calIndex_X = x_index -1;

							var length = 96+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 97 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 287+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 30 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;


					case 5:
					{
						if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-1;
							var calIndex_X = x_index -1;

							var length = 24+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 60 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 188 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -21 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 6:
					{
						if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-2;
							var calIndex_X = x_index -2;

							var length = 22+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = 30 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 158 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -35 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 7:
					{
						if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-3;
							var calIndex_X = x_index -3;

							var length = 16+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -2 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 128 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -50 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 8:
					{
						if(hole_index > 4 && hole_index <=8){
							var calIndex = hole_index - 4-4;
							var calIndex_X = x_index -4;

							var length = 13+ calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = 50;
							//先hardCode看下
							pointCube.position.y = -33 - calIndex*15 - calIndex_X *2;					//起始是220
						}else if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 98 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -64 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					}
					break;

					case 9:
						if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -1;
							var calIndex_X = x_index -1;

							var length = 24 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -102 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					break;

					case 10:
						if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -2;
							var calIndex_X = x_index -2;

							var length = 20 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -133 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					break;

					case 11:
						if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -3;
							var calIndex_X = x_index -3;

							var length = 14 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -165 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					break;
					case 12:
						if(hole_index >8 && hole_index<=12){
							var calIndex = hole_index - 8 -4;
							var calIndex_X = x_index - 4;

							var length = 12 + calIndex*30 - calIndex_X * 4;
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, length, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -50;
							pointCube.position.z = z_position;
							//先hardCode看下
							pointCube.position.y = -196 - calIndex*15 - calIndex_X *2;					//起始是220
						}
					break;
				}
				scene.add(pointCube);
			}
			//72芯到边角的线
			function drawLinePointToCircleOne(holeIndex){
				//holeIndex = 4;
				var z_position = 46;
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );

				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 13, 18, 1);

				//pointCube
				var pointCube = new THREE.Mesh(geometry1, material);
				pointCube.rotation.z = 1.57;
				pointCube.position.x = -55;				//holeIndx = 1 . x = 55
				pointCube.position.z = z_position;

				var geometry2 = new THREE.CylinderGeometry(0.5, 0.5, 66, 18, 1);
				var pointCubeExt = new THREE.Mesh(geometry2, material);
				pointCubeExt.rotation.x = 1.58;
				pointCubeExt.position.x = -62;
				pointCubeExt.position.z = 13;


				switch(holeIndex){
					case 1:
						pointCube.position.y = 207;
						pointCubeExt.position.y = 207;

					break;
					case 2:
						pointCube.position.y = 207 -28.5;
						pointCubeExt.position.y = 207 -28.5;
					break;
					case 3:
						pointCube.position.y = 207 -57;
						pointCubeExt.position.y = 207 -57;

					break;
					case 4:
					{
						pointCube.position.y = 207 -87;
						pointCubeExt.position.y = 207 -87;

					}
					break;
					case 5:
					{
						pointCube.position.y = 207 -159;
						pointCubeExt.position.y = 207 -159;

					}
					break;
					case 6:
					{
						pointCube.position.y = 207 -187;
						pointCubeExt.position.y = 207 -187;
					}
					break;
					case 7:{
						pointCube.position.y = 207 -217;
						pointCubeExt.position.y = 207 -217;
					}
					break;
					case 8:
					{
						pointCube.position.y = 207 -248;
						pointCubeExt.position.y = 207 -248;
					}
					break;
					case 9:
					{
						pointCube.position.y = 207 -323;
						pointCubeExt.position.y = 207 -323;
					}
					break;
					case 10:
					{
						pointCube.position.y = 207 -351;
						pointCubeExt.position.y = 207 -351;
					}
					break;
					case 11:
					{
						pointCube.position.y = 207 -380;
						pointCubeExt.position.y = 207 -380;
					}
					break;
					case 12:
					{
						pointCube.position.y = 207 -410;
						pointCubeExt.position.y = 207 -410;
					}
					break;

				}
				scene.add(pointCube);
				scene.add(pointCubeExt);
			}

			/*
			* 画挂纤轮
			* ---------------------开始-------------------------
			*/
			function drawLineLoop(lineLoopIndex, holeIndex, bigLineLoop, bigLineLoopIndex){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );

				//先画挂纤轮与大小孔间的线
				drawLineLoopToHole(lineLoopIndex, holeIndex);

				//画挂纤轮上的线
				drawLineLoopHor(lineLoopIndex); //lineLoopIndex

				//画挂纤轮到线环的线
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 65, 18, 1);
				var pointCube2 = new THREE.Mesh(geometry1, material);
				pointCube2.rotation.y = 1.58;
				pointCube2.position.x = -62;
				pointCube2.position.z = -60;
				pointCube2.position.y = 212;
				scene.add(pointCube2);
			}

			//画挂纤轮上的线
			function drawLineLoopHor(lineLoopIndex){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 40, 18, 1);
				var pointCube1 = new THREE.Mesh(geometry1, material);
				pointCube1.rotation.x = 1.58;
				pointCube1.position.x = -62;
				pointCube1.position.z = -40;
				pointCube1.position.y = 244 - (lineLoopIndex -1 )*35;	//1-244
				scene.add(pointCube1);
			}

			//画挂线轮到大小孔的线
			function drawLineLoopToHole(lineLoopIndex, holeIndex){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				//lineLoopIndex =13;
				//holeIndex = 12;
				//进行switch判断

				switch(lineLoopIndex)
				{
					case 1:
					{
						if(holeIndex <= 4){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 37 + (holeIndex -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 226 - (holeIndex -1)*14.5;
						}else if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 196 + (holeIndex - 4 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 146 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 360 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 64 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;
					case 2:
					{
						if(holeIndex <= 4){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 31 + (holeIndex -2 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 208 - (holeIndex -1)*14.5;
						}else if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 162 + (holeIndex - 4 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 129 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 325 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 47 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;
					case 3:
					{
						if(holeIndex <= 4){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 26 + (holeIndex -3 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 191 - (holeIndex -1)*14.5;
						}else if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 126 + (holeIndex - 4 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 111 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 290 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 29 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;
					case 4:
					{
						if(holeIndex <= 4){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 18 + (holeIndex -4 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 173 - (holeIndex -1)*14.5;
						}else if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 91 + (holeIndex - 4 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 94 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 255 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 11 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;

					case 5:
					{
						if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 56 + (holeIndex - 4 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 76 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 220 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -6 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;
					case 6:
					{
						if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 20 + (holeIndex - 4 -1 )* 30, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 60 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 185 + (holeIndex - 8 -1 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -23 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;

					case 7:
					{
						if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 44 + (holeIndex -7 )* 30, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 42 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 92 + (holeIndex - 7 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -41 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;

					case 8:
					{
						if(holeIndex <= 8){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 40 + (holeIndex -8 )* 30, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = 24 - (holeIndex - 4 -1)*15;
						}else if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 86 + (holeIndex - 8 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -58 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;

					case 9:
					{
						if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 80 + (holeIndex - 9 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -76 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;

					case 10:
					{
						if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 74 + (holeIndex - 10 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -93 - (holeIndex - 8 -1)*14.5;
						}

						scene.add(pointCube);
					}
					break;
					case 11:
					{
						if(holeIndex <= 12){
							if(holeIndex == 9){
								var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 48 + (holeIndex - 11 )* 29, 18, 1);
								var pointCube = new THREE.Mesh(geometry1, material);
								pointCube.rotation.y = 1.58;
								pointCube.position.x = -62;
								pointCube.position.z = -20;
								pointCube.position.y = -111 - (holeIndex - 8 -1)*14.5;
							}else{
								var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 68 + (holeIndex - 11 )* 29, 18, 1);
								var pointCube = new THREE.Mesh(geometry1, material);
								pointCube.rotation.y = 1.58;
								pointCube.position.x = -62;
								pointCube.position.z = -20;
								pointCube.position.y = -111 - (holeIndex - 8 -1)*14.5;
							}

						}

						scene.add(pointCube);
					}
					break;
					case 12:
					{
						if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 31 + (holeIndex - 11 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -128 - (holeIndex - 8 -1)*14.5;
						}
						scene.add(pointCube);
					}
					break;
					case 13:
					{
						if(holeIndex <= 12){
							var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 27 + (holeIndex - 12 )* 29, 18, 1);
							var pointCube = new THREE.Mesh(geometry1, material);
							pointCube.rotation.y = 1.58;
							pointCube.position.x = -62;
							pointCube.position.z = -20;
							pointCube.position.y = -145 - (holeIndex - 8 -1)*14.5;
						}
						scene.add(pointCube);
					}
					break;

				}

			}
			/*---------------------结束-------------------------*/

			/*
			*  画96芯的点
			*
			*/
			function drawPointOf96(ModelIndex, X_Index, Y_Index){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				/*
				* 长度跟X有关， x坐标跟y有关
				*/
				//ModelIndex = 1;
				/*
				* 1, 1的长度30, X = 36
				*
				*/
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 28 - (X_Index -1) *4, 18, 1);
				var pointCube = new THREE.Mesh(geometry1, material);
				pointCube.rotation.y = 1.58;
				pointCube.position.x = 36 - (Y_Index -1) *3.4;
				pointCube.position.z = -125; //z是不变的
				pointCube.position.y = 225 - (X_Index  - 1)*2  - 53*(ModelIndex -1);

				scene.add(pointCube);
			}

			/*
			* hu
			*/

			function drawLinePointToCircle(model_index, x_index){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 83, 18, 1);
				var pointCube = new THREE.Mesh(geometry1, material);
				pointCube.rotation.x = 1.58;
				pointCube.position.x = -214;
				pointCube.position.z = 9;

				switch(model_index){
					case 1:
					{
						pointCube.position.y = 232 - (x_index - 1)*4;
					}
					break;

					case 2:
					{
						pointCube.position.y = 202 - (x_index - 1)*4;

					}
					break;

					case 3:
					{
						pointCube.position.y = 174 - (x_index - 1)*4;
					}
					break;
					case 4:
						pointCube.position.y = 144 - (x_index - 1)*4;
					break;


					case 5:
						pointCube.position.y = 72 - (x_index - 1)*4;
					break;

					case 6:
						pointCube.position.y = 44 - (x_index - 1)*4;

					break;

					case 7:
						pointCube.position.y = 14 - (x_index - 1)*4;

					break;

					case 8:
						pointCube.position.y = -15 - (x_index - 1)*4;
					break;

					case 9:
						pointCube.position.y = -90 - (x_index - 1)*4;

					break;

					case 10:
						pointCube.position.y = -120 - (x_index - 1)*4;

					break;

					case 11:
						pointCube.position.y = -150 - (x_index - 1)*4;

					break;
					case 12:
						pointCube.position.y = -178 - (x_index - 1)*4;
					break;
				}

				scene.add(pointCube);
			}

			function drawCircle(index){
				var geometry = new THREE.TorusGeometry(10,1,12,18);
		        var material = new THREE.MeshBasicMaterial({color: 0xfdc534});
		        var torus = new THREE.Mesh(geometry,material);
				//第一个环的坐标
				torus.rotation.y = 1.58;
				torus.position.x = -214;
				torus.position.z = -41;
				torus.position.y = 232 - (index -1)*35;

		        scene.add(torus);
			}

			function drawCircleToCircle(start_index, end_index){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 40 + (end_index -(start_index +1))*35, 18, 1);
				var pointCube = new THREE.Mesh(geometry1, material);
				pointCube.position.x = -214;
				pointCube.position.z = -51;
				pointCube.position.y = (215 - (start_index - 1)*35) - (end_index -(start_index +1)) *17.5;
				scene.add(pointCube);
			}

			function drawLine(start_index, end_index){
				var material = new THREE.MeshBasicMaterial( { color: 0xfdc534 } );
				var geometry1 = new THREE.CylinderGeometry(0.5, 0.5, 40 + (end_index -(start_index +1))*35, 18, 1);
				var pointCube = new THREE.Mesh(geometry1, material);
				pointCube.position.x = -214;
				pointCube.position.z = -32;
				pointCube.position.y = (215 - (start_index - 1)*35) - (end_index -(start_index +1)) *17.5;
				scene.add(pointCube);
			}


		/*
		img icon function
		(1)left rotation
		(2)right rotation
		(3)zoom in
		(4)zoom out
		(5)reset
		*/
		function initImageIcon(){
			/*left rotation*/
			var left_img_icon = document.getElementById('turnleft_icon');
			left_img_icon.addEventListener("mousedown", left_down);
			left_img_icon.addEventListener("mouseup", left_up);

			/*right rotation*/
			var right_img_icon = document.getElementById('turnright_icon');
			right_img_icon.addEventListener("mousedown", right_down);
			right_img_icon.addEventListener("mouseup", right_up);

			/*zoom in*/
			var zoomin_img_icon = document.getElementById('zoomin_icon');
			zoomin_img_icon.addEventListener("mousedown", zoomIn_down);
			zoomin_img_icon.addEventListener("mouseup", zoomIn_up);

			/*zoom out*/
			var zoomout_img_icon = document.getElementById('zoomout_icon');
			zoomout_img_icon.addEventListener("mousedown", zoomOut_down);
			zoomout_img_icon.addEventListener("mouseup", zoomOut_up);

			/*reset icon*/
			var img_icon = document.getElementById('reset_icon');
			img_icon.addEventListener("mousedown", resetdown);
			img_icon.addEventListener("mouseup", resetup);

			/*left icon*/
			var left_icon = document.getElementById('left_icon');
			left_icon.addEventListener("click", goto_left);
			/*right icon*/
			var right_icon = document.getElementById('right_icon');
			right_icon.addEventListener("click", goto_right);
		}

		/*left*/
		function goto_left(){
			console.log("zlwu add for goto left, json_index is"+json_index);
			if(json_index >0){
				json_index--;
				var x = json1.step0[json_index];
				document.getElementById("step_text").innerHTML=x;
			}
		}

		/*right*/
		function goto_right(){
			console.log("zlwu add for goto right, json_index is"+json_index);
			if(json_index < json1.step0.length){
				json_index++;
				var x = json1.step0[json_index];
				document.getElementById("step_text").innerHTML=x;
			}
		}

		/*left rotation*/
		function left_down(){
			var left_img_icon = document.getElementById('turnleft_icon');
			left_img_icon.src = "./images/btn-turnleft-press.png";
		}

		function left_up(){
			var left_img_icon = document.getElementById('turnleft_icon');
			left_img_icon.src = "./images/btn-turnleft-normal.png";
			controls.rotate(1);
		}

		/*right rotation*/
		function right_down(){
			var right_img_icon = document.getElementById('turnright_icon');
			right_img_icon.src = "./images/btn-turnright-press.png";
		}

		function right_up(){
			var right_img_icon = document.getElementById('turnright_icon');
			right_img_icon.src = "./images/btn-turnright-normal.png";
			controls.rotate(2);

		}

		/*zoom in*/
		function zoomIn_down(){
			var zoom_img_icon = document.getElementById('zoomin_icon');
			zoom_img_icon.src = "./images/btn-zoomin-press.png";
		}

		function zoomIn_up(){
			var zoom_img_icon = document.getElementById('zoomin_icon');
			zoom_img_icon.src = "./images/btn-zoomin-normal.png";
			zoomMode(1);
		}
		/*zoom out*/
		function zoomOut_down(){
			var zoom_img_icon = document.getElementById('zoomout_icon');
			zoom_img_icon.src = "./images/btn-zoomout-press.png";
		}

		function zoomOut_up(){
			var zoom_img_icon = document.getElementById('zoomout_icon');
			zoom_img_icon.src = "./images/btn-zoomout-normal.png";
			zoomMode(2);
		}


		/*reset*/
		function resetdown(){
			var img_icon = document.getElementById('reset_icon');
			img_icon.src = "./images/btn-reset-press.png";
		}
		function resetup(){
			var img_icon = document.getElementById('reset_icon');
			img_icon.src = "./images/btn-reset-normal.png";
			controls.reset();
		}

		/*zoom*/
		function zoomMode(value){
			controls.zoomAdjust(value);
		}

		/*
		* 根据step的string来判断是哪种情况
		*/
		function checkStepString(stepString){
			/*
			* A(1,1)		->1
			* A-小孔         ->2
			* B-大孔         ->3
			* 挂纤轮-1       ->4
			* 2-大线环1		->5
			* 2(1,1)		->6
			*/
			var index = stepString.indexOf("挂纤轮");
			if(StringExist(stepString, "小孔")){
				return 2;
			}else if(StringExist(stepString, "大孔")){
				return 3;
			}else if(StringExist(stepString,"挂纤轮")){
				//挂线轮
				return 4;
			}else if(StringExist(stepString,"(")||StringExist(stepString,")")){
				//72／96芯的孔
				var firstChar = parseInt(stepString.substr(0, 1));
				if(firstChar >= 1 && firstChar <=10){
					return 6;
				}else{
					return 1;
				}
			}
		}

		function StringExist(stepString, checkString){
			if(stepString.indexOf(checkString) >= 0 ){
				return 1;
			}else{
				return 0;
			}
		}

		//进行绘画动作
		/*
		* 画出口的线， 分为72芯片还是96芯出来
		*/
		function drawStartLine(startType, startModel, start_X, start_Y)
		{
			if(startType == 0){		//72芯
				drawPointLine();
			}else{					//96芯

			}
		}

		</script>

	</body>
</html>
